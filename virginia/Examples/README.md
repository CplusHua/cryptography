###
###    Date:2018-08-02
###   Time:11:50 GMT
###  Author:nianhua
###

encode.cpp是加密程序文件</br>
code.txt是加密后的密文

解析：其实这是维吉尼亚密码的变形，使用一个固定的密钥去异或一串字符。举例：
````
 a    b    c    d    e    f    g    h    i        明文
 ^    ^    ^    ^    ^    ^    ^    ^    ^        异或
0x11 0x1A 0x25 0x11 0x1A 0x25 0x11 0x1A 0x25      密钥(循环的-->0x11 0x1A 0x25)
0x70 0X78 0X46 0X75 0X7F 0X43 0X76 0X72 0x4C      密文
````
所以解这个题，首先需要判断出密钥长度是多少，这里可以使用卡西斯基测试</br>或者friedman测试，从而判断出密钥长度
````
---------------------------------------------------------------------------------------
 以下是kasiski程序示例输出：
---------------------------------------------------------------------------------------
└──╼ $python3 kasiski.py 
请输入密文:F96DE8C227A259C87EE1DA2AED57C93FE5DA36ED4EC87EF2C63AAE5B9A7EFFD673BE4ACF7BE8923CAB1ECE7AF2DA3DA44FCF7AE29235A24C963FF0DF3CA3599A70E5DA36BF1ECE77F8DC34BE129A6CF4D126BF5B9A7CFEDF3EB850D37CF0C63AA2509A76FF9227A55B9A6FE3D720A850D97AB1DD35ED5FCE6BF0D138A84CC931B1F121B44ECE70F6C032BD56C33FF9D320ED5CDF7AFF9226BE5BDE3FF7DD21ED56CF71F5C036A94D963FF8D473A351CE3FE5DA3CB84DDB71F5C17FED51DC3FE8D732BF4D963FF3C727ED4AC87EF5DB27A451D47EFD9230BF47CA6BFEC12ABE4ADF72E29224A84CDF3FF5D720A459D47AF59232A35A9A7AE7D33FB85FCE7AF5923AA31EDB3FF7D33ABF52C33FF0D673A551D93FFCD33DA35BC831B1F43CBF1EDF67F0DF23A15B963FE5DA36ED68D378F4DC36BF5B9A7AFFD121B44ECE76FEDC73BE5DD27AFCD773BA5FC93FE5DA3CB859D26BB1C63CED5CDF3FE2D730B84CDF3FF7DD21ED5ADF7CF0D636BE1EDB79E5D721ED57CE3FE6D320ED57D469F4DC27A85A963FF3C727ED49DF3FFFDD24ED55D470E69E73AC50DE3FE5DA3ABE1EDF67F4C030A44DDF3FF5D73EA250C96BE3D327A84D963FE5DA32B91ED36BB1D132A31ED87AB1D021A255DF71B1C436BF479A7AF0C13AA14794
请输入最短相似长度（一般为3或4或更长）4
如果没有找到相似字符串，请降低最短相似长度
如果没有找到相同公因子，请增加最短相似长度
{'227A': 196, 'C87E': 28, 'ED57': 714, 'D57C': 714, 'C93F': 630, '93FE': 630, '3FE5': 322, 'FE5D': 322, 'E5DA': 98, '5DA3': 98, 'DA36': 98, 'A36E': 560, '36ED': 560, '87EF': 364, 'C63A': 140, '63AA': 140, '5B9A': 112, 'B9A7': 112, 'D673': 476, '73BE': 574, 'BE4A': 378, '1ECE': 56, 'ECE7': 56, 'CE7A': 420, 'E7AF': 420, 'E292': 350, '963F': 224, '63FF': 224, '3FF0': 420, 'FF0D': 420, 'F0DF': 462, '36BF': 476, 'BF1E': 434, '6BF5': 448, 'BF5B': 448, 'F5B9': 448, '850D': 42, '7CF0': 532, 'A250': 658, 'FF92': 98, 'F922': 98, 'D720': 252, '720A': 252, '7AB1': 672, 'AB1D': 672, '5FCE': 266, 'A84C': 210, '31B1': 308, '1B1F': 308, '121B': 364, '21B4': 364, '1B44': 364, 'B44E': 364, '44EC': 364, '4ECE': 364, 'D56C': 42, 'C33F': 252, '33FF': 252, 'D320': 462, '320E': 462, '20ED': 462, '0ED5': 462, 'ED5C': 392, 'D5CD': 392, '5CDF': 392, '7AFF': 322, 'DE3F': 504, '3FF7': 210, 'FF7D': 210, 'F7DD': 392, '7DD2': 392, 'DD21': 392, 'D21E': 392, '21ED': 392, '1ED5': 392, '71F5': 42, '1F5C': 42, '4D96': 56, 'D963': 56, 'CE3F': 392, 'E3FE': 392, 'DA3C': 308, 'A3CB': 308, '3CB8': 308, '3FF3': 378, 'FF3C': 378, 'F3C7': 378, '3C72': 378, 'C727': 378, '727E': 378, '27ED': 378, '7ED4': 378, 'BF47': 490, 'ADF7': 266, '84CD': 238, '4CDF': 238, 'CDF3': 224, 'DF3F': 224, 'F3FF': 238, '3FF5': 378, 'FF5D': 378, 'F5D7': 378, '5D72': 266, '7AF5': 28, 'AF59': 28, 'F592': 28, '5923': 28, '32A3': 406, '9A7A': 126, '7D33': 28, 'A31E': 378, '31ED': 378, '1EDB': 210, 'F0D6': 182, '1EDF': 252, 'EDF6': 252, 'DF67': 252, 'F67F': 252, '63FE': 280, 'F4DC': 154, 'A7AF': 308, '6BB1': 210, 'BE1E': 98, 'E1ED': 98, '27A8': 98}
227A:{2, 98, 4, 7, 14, 49, 28}
C87E:{2, 4, 14, 7}
ED57:{2, 3, 34, 357, 6, 7, 102, 42, 238, 14, 17, 51, 21, 119}
D57C:{2, 3, 34, 357, 6, 7, 102, 42, 238, 14, 17, 51, 21, 119}
C93F:{2, 3, 5, 6, 7, 9, 10, 14, 15, 18, 21, 30, 35, 42, 45, 315, 63, 70, 210, 90, 105, 126}
93FE:{2, 3, 5, 6, 7, 9, 10, 14, 15, 18, 21, 30, 35, 42, 45, 315, 63, 70, 210, 90, 105, 126}
3FE5:{161, 2, 7, 14, 46, 23}
FE5D:{161, 2, 7, 14, 46, 23}
E5DA:{49, 2, 14, 7}
5DA3:{49, 2, 14, 7}
DA36:{49, 2, 14, 7}
A36E:{2, 35, 4, 5, 70, 7, 8, 40, 10, 140, 14, 112, 80, 16, 20, 280, 56, 28}
36ED:{2, 35, 4, 5, 70, 7, 8, 40, 10, 140, 14, 112, 80, 16, 20, 280, 56, 28}
87EF:{2, 4, 7, 13, 14, 52, 182, 26, 91, 28}
C63A:{2, 35, 4, 5, 70, 7, 10, 14, 20, 28}
63AA:{2, 35, 4, 5, 70, 7, 10, 14, 20, 28}
····省略了一部分····
BE1E:{49, 2, 14, 7}
E1ED:{49, 2, 14, 7}
27A8:{49, 2, 14, 7}
----------------------------------------
统计密钥长度可能性:
因子:次数
  2:125
  7:125
 14:125
  4: 67
 28: 61
  3: 48
  6: 48
 21: 48
····
---------------------------------------------------------------------------------------
 程序输出结束。
---------------------------------------------------------------------------------------
````
从结果中没有办法判断出密钥长度到底是多少，但是大概可以看出是7 （因为2太短了，14太长了）</br>
需要注意的是，在这个程序中，不能用之间的脚本进行测试，所以我们修改一下脚本</br>
使用ctf-friedman再来测试以下：
````
---------------------------------------------------------------------------------------
 以下是ctf-friedman程序示例输出：
---------------------------------------------------------------------------------------
└──╼ $python3 ctf-friedman.py 
---------------------------
猜测密钥长度为5
0.013955616563715396
0.009380004575611988
0.013269274765499885
0.01098146877144818
0.009380004575611988
---------------------------
猜测密钥长度为6
0.007140538786108407
0.0103862382343395
0.01098901098901099
0.019314019314019316
0.006993006993006993
0.009657009657009658
---------------------------
猜测密钥长度为7                    --->除了第二密钥对应的密文外，其他的都接近0.0667
0.07243195785776997
0.14382632293080055
0.056535504296698326
0.06060606060606061
0.0574400723654455
0.0877431026684758
0.048846675712347354
---------------------------
猜测密钥长度为8
0.008182349503214495
0.011104617182933957
0.013442431326709527
0.011104617182933957
0.0070134424313267095
0.008766803039158387
0.007864488808227465
0.015124016938898971
---------------------------
猜测密钥长度为9
0.01088534107402032
0.00725689404934688
0.011312217194570135
0.008295625942684766
0.003770739064856712
0.011312217194570135
0.023378582202111614
0.010558069381598794
0.010558069381598794
---------------------------
猜测密钥长度为10
0.010175763182238668
0.009250693802035153
0.0074005550416281225
0.01572617946345976
0.0064754856614246065
0.01572617946345976
0.009250693802035153
0.018501387604070305
0.010175763182238668
0.011100832562442183
---------------------------
猜测密钥长度为11
0.013289036544850499
0.014396456256921373
0.01107419712070875
0.015503875968992248
0.017718715393133997
0.008859357696566999
0.006644518272425249
0.009966777408637873
0.0023228803716608595
0.012775842044134728
0.008130081300813009
---------------------------
猜测密钥长度为12
0.005128205128205128
0.00641025641025641
0.005398110661268556
0.017543859649122806
0.004048582995951417
0.006747638326585695
0.006747638326585695
0.012145748987854251
0.010796221322537112
0.014844804318488529
0.009446693657219974
0.010796221322537112
---------------------------
猜测密钥长度为13
0.016516516516516516
0.0075075075075075074
0.012698412698412698
0.007936507936507936
0.009523809523809525
0.012698412698412698
0.007936507936507936
0.011111111111111112
0.009523809523809525
0.006349206349206349
0.0031746031746031746
0.007936507936507936
0.006349206349206349
---------------------------
猜测密钥长度为14
0.0659536541889483
0.1925133689839572
0.0659536541889483
0.058823529411764705
0.0659536541889483
0.1265597147950089
0.0392156862745098
0.08377896613190731
0.10227272727272728
0.03977272727272727
0.0625
0.054924242424242424
0.07196969696969698
0.07386363636363637

---------------------------------------------------------------------------------------
 程序输出结束。
---------------------------------------------------------------------------------------
````







